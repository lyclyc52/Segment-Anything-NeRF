[INFO] Trainer: ngp | 2023-09-05_23-35-20 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_teatime/checkpoints/ngp_ep0005.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=8192, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_teatime/checkpoints/ngp_ep0005.pth ...
[INFO] loaded model.
[INFO] load at epoch 5, global step 1545
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_14-04-48 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_debug/checkpoints/ngp_ep0004.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=8192, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_debug/checkpoints/ngp_ep0004.pth ...
[INFO] loaded model.
[INFO] load at epoch 4, global step 1236
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_14-13-01 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_no_rgb_similarity/checkpoints/ngp_ep0004.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=8192, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_no_rgb_similarity/checkpoints/ngp_ep0004.pth ...
[INFO] loaded model.
[INFO] load at epoch 4, global step 1236
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_14-23-29 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_no_rgb_similarity/checkpoints/ngp_ep0008.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=8192, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_no_rgb_similarity/checkpoints/ngp_ep0008.pth ...
[INFO] loaded model.
[INFO] load at epoch 8, global step 2472
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_14-24-33 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_similarity/checkpoints/ngp_ep0008.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=8192, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_similarity/checkpoints/ngp_ep0008.pth ...
[INFO] loaded model.
[INFO] load at epoch 8, global step 2472
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_14-25-59 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_similarity/checkpoints/ngp_ep0017.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=8192, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_similarity/checkpoints/ngp_ep0017.pth ...
[INFO] loaded model.
[INFO] load at epoch 17, global step 5253
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_14-56-48 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_similarity_2/checkpoints/ngp_ep0004.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=8192, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_similarity_2/checkpoints/ngp_ep0004.pth ...
[INFO] loaded model.
[INFO] load at epoch 4, global step 1236
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_14-58-29 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_similarity_2/checkpoints/ngp_ep0008.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=8192, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_similarity_2/checkpoints/ngp_ep0008.pth ...
[INFO] loaded model.
[INFO] load at epoch 8, global step 2472
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_15-06-21 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin/checkpoints/ngp_ep0008.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin/checkpoints/ngp_ep0008.pth ...
[INFO] loaded model.
[INFO] load at epoch 8, global step 2472
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_15-09-31 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert/checkpoints/ngp_ep0005.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert/checkpoints/ngp_ep0005.pth ...
[INFO] loaded model.
[INFO] load at epoch 5, global step 1545
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_15-10-25 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert/checkpoints/ngp_ep0008.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert/checkpoints/ngp_ep0008.pth ...
[INFO] loaded model.
[INFO] load at epoch 8, global step 2472
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_15-12-28 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert/checkpoints/ngp_ep0012.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert/checkpoints/ngp_ep0012.pth ...
[INFO] loaded model.
[INFO] load at epoch 12, global step 3708
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_15-14-02 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert/checkpoints/ngp_ep0017.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert/checkpoints/ngp_ep0017.pth ...
[INFO] loaded model.
[INFO] load at epoch 17, global step 5253
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_15-14-45 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert/checkpoints/ngp_ep0012.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert/checkpoints/ngp_ep0012.pth ...
[INFO] loaded model.
[INFO] load at epoch 12, global step 3708
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_15-16-33 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_no_rgb_similarity/checkpoints/ngp_ep0012.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_no_rgb_similarity/checkpoints/ngp_ep0012.pth ...
[INFO] loaded model.
[INFO] load at epoch 12, global step 3708
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_15-18-07 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_no_rgb_similarity/checkpoints/ngp_ep0012.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_no_rgb_similarity/checkpoints/ngp_ep0012.pth ...
[INFO] Trainer: ngp | 2023-09-06_15-22-18 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin/checkpoints/ngp_ep0005.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin/checkpoints/ngp_ep0005.pth ...
[INFO] loaded model.
[INFO] load at epoch 5, global step 1655
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_15-24-05 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin/checkpoints/ngp_ep0010.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin/checkpoints/ngp_ep0010.pth ...
[INFO] loaded model.
[INFO] load at epoch 10, global step 3310
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_15-26-54 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim/checkpoints/ngp_ep0005.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim/checkpoints/ngp_ep0005.pth ...
[INFO] loaded model.
[INFO] load at epoch 5, global step 1655
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_15-28-46 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim/checkpoints/ngp_ep0010.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim/checkpoints/ngp_ep0010.pth ...
[INFO] loaded model.
[INFO] load at epoch 10, global step 3310
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_15-31-17 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim/checkpoints/ngp_ep0017.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim/checkpoints/ngp_ep0017.pth ...
[INFO] Trainer: ngp | 2023-09-06_15-31-36 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim/checkpoints/ngp_ep0016.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim/checkpoints/ngp_ep0016.pth ...
[INFO] loaded model.
[INFO] load at epoch 16, global step 5296
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_15-38-17 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin/checkpoints/ngp_ep0016.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin/checkpoints/ngp_ep0016.pth ...
[INFO] loaded model.
[INFO] load at epoch 16, global step 5296
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_15-41-33 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert/checkpoints/ngp_ep0015.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert/checkpoints/ngp_ep0015.pth ...
[INFO] loaded model.
[INFO] load at epoch 15, global step 4965
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_15-53-44 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert/checkpoints/ngp_ep0003.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert/checkpoints/ngp_ep0003.pth ...
[INFO] loaded model.
[INFO] load at epoch 3, global step 993
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_15-54-23 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert/checkpoints/ngp_ep0005.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert/checkpoints/ngp_ep0005.pth ...
[INFO] loaded model.
[INFO] load at epoch 5, global step 1655
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_15-58-27 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert/checkpoints/ngp_ep0016.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert/checkpoints/ngp_ep0016.pth ...
[INFO] loaded model.
[INFO] load at epoch 16, global step 5296
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_16-16-08 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert/checkpoints/ngp_ep0016.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert/checkpoints/ngp_ep0016.pth ...
[INFO] Trainer: ngp | 2023-09-06_16-45-44 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select/checkpoints/ngp_ep0006.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select/checkpoints/ngp_ep0006.pth ...
[INFO] loaded model.
[INFO] load at epoch 6, global step 1986
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_16-46-15 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select/checkpoints/ngp_ep0009.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select/checkpoints/ngp_ep0009.pth ...
[INFO] loaded model.
[INFO] load at epoch 9, global step 2979
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_16-47-20 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select/checkpoints/ngp_ep0012.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select/checkpoints/ngp_ep0012.pth ...
[INFO] loaded model.
[INFO] load at epoch 12, global step 3972
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_16-51-03 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert_3/checkpoints/ngp_ep0006.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert_3/checkpoints/ngp_ep0006.pth ...
[INFO] loaded model.
[INFO] load at epoch 6, global step 1986
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_16-51-50 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert_3/checkpoints/ngp_ep0009.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert_3/checkpoints/ngp_ep0009.pth ...
[INFO] loaded model.
[INFO] load at epoch 9, global step 2979
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_16-54-03 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert_3/checkpoints/ngp_ep0016.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert_3/checkpoints/ngp_ep0016.pth ...
[INFO] loaded model.
[INFO] load at epoch 16, global step 5296
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_16-55-37 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select/checkpoints/ngp_ep0016.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select/checkpoints/ngp_ep0016.pth ...
[INFO] loaded model.
[INFO] load at epoch 16, global step 5296
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_17-09-38 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_1/checkpoints/ngp_ep0008.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_1/checkpoints/ngp_ep0008.pth ...
[INFO] loaded model.
[INFO] load at epoch 8, global step 2648
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_17-10-15 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_1/checkpoints/ngp_ep0010.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_1/checkpoints/ngp_ep0010.pth ...
[INFO] loaded model.
[INFO] load at epoch 10, global step 3310
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_17-11-51 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_1/checkpoints/ngp_ep0016.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_1/checkpoints/ngp_ep0016.pth ...
[INFO] loaded model.
[INFO] load at epoch 16, global step 5296
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_17-14-11 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert_4/checkpoints/ngp_ep0004.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert_4/checkpoints/ngp_ep0004.pth ...
[INFO] loaded model.
[INFO] load at epoch 4, global step 1324
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_17-14-47 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert_4/checkpoints/ngp_ep0006.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert_4/checkpoints/ngp_ep0006.pth ...
[INFO] loaded model.
[INFO] load at epoch 6, global step 1986
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_17-16-23 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert_4/checkpoints/ngp_ep0010.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert_4/checkpoints/ngp_ep0010.pth ...
[INFO] loaded model.
[INFO] load at epoch 10, global step 3310
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_17-16-58 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert_4/checkpoints/ngp_ep0010.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert_4/checkpoints/ngp_ep0010.pth ...
[INFO] loaded model.
[INFO] load at epoch 10, global step 3310
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_17-17-46 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert_4/checkpoints/ngp_ep0012.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert_4/checkpoints/ngp_ep0012.pth ...
[INFO] Trainer: ngp | 2023-09-06_17-17-59 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert_4/checkpoints/ngp_ep0011.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert_4/checkpoints/ngp_ep0011.pth ...
[INFO] loaded model.
[INFO] load at epoch 11, global step 3641
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_17-18-29 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert_4/checkpoints/ngp_ep0011.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert_4/checkpoints/ngp_ep0011.pth ...
[INFO] loaded model.
[INFO] load at epoch 11, global step 3641
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_17-19-46 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_1/checkpoints/ngp_ep0003.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_1/checkpoints/ngp_ep0003.pth ...
[INFO] loaded model.
[INFO] load at epoch 3, global step 993
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_17-20-52 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_1/checkpoints/ngp_ep0006.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_1/checkpoints/ngp_ep0006.pth ...
[INFO] loaded model.
[INFO] load at epoch 6, global step 1986
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_17-21-34 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_1/checkpoints/ngp_ep0006.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_1/checkpoints/ngp_ep0006.pth ...
[INFO] loaded model.
[INFO] load at epoch 6, global step 1986
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_17-22-35 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_1/checkpoints/ngp_ep0016.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_1/checkpoints/ngp_ep0016.pth ...
[INFO] loaded model.
[INFO] load at epoch 16, global step 5296
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_17-23-30 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_1/checkpoints/ngp_ep0015.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_1/checkpoints/ngp_ep0015.pth ...
[INFO] loaded model.
[INFO] load at epoch 15, global step 4965
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_17-25-49 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_1/checkpoints/ngp_ep0016.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_1/checkpoints/ngp_ep0016.pth ...
[INFO] loaded model.
[INFO] load at epoch 16, global step 5296
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_17-26-50 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_1/checkpoints/ngp_ep0006.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_1/checkpoints/ngp_ep0006.pth ...
[INFO] loaded model.
[INFO] load at epoch 6, global step 1986
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_17-27-37 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert_4/checkpoints/ngp_ep0006.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_with_uncert_4/checkpoints/ngp_ep0006.pth ...
[INFO] loaded model.
[INFO] load at epoch 6, global step 1986
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_17-30-19 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_1/checkpoints/ngp_ep0005.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_1/checkpoints/ngp_ep0005.pth ...
[INFO] loaded model.
[INFO] load at epoch 5, global step 1655
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_17-31-14 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_2/checkpoints/ngp_ep0005.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_2/checkpoints/ngp_ep0005.pth ...
[INFO] loaded model.
[INFO] load at epoch 5, global step 1655
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_17-32-34 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_2/checkpoints/ngp_ep0004.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_2/checkpoints/ngp_ep0004.pth ...
[INFO] loaded model.
[INFO] load at epoch 4, global step 1324
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_17-33-08 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_1/checkpoints/ngp_ep0004.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_1/checkpoints/ngp_ep0004.pth ...
[INFO] loaded model.
[INFO] load at epoch 4, global step 1324
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_17-33-40 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_1/checkpoints/ngp_ep0005.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_1/checkpoints/ngp_ep0005.pth ...
[INFO] loaded model.
[INFO] load at epoch 5, global step 1655
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_17-35-42 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_2/checkpoints/ngp_ep0003.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_2/checkpoints/ngp_ep0003.pth ...
[INFO] loaded model.
[INFO] load at epoch 3, global step 993
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_19-36-28 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_3/checkpoints/ngp_ep0004.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_3/checkpoints/ngp_ep0004.pth ...
[INFO] loaded model.
[INFO] load at epoch 4, global step 1324
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_19-37-53 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_3/checkpoints/ngp_ep0011.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_3/checkpoints/ngp_ep0011.pth ...
[INFO] loaded model.
[INFO] load at epoch 11, global step 3641
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_19-39-52 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_3/checkpoints/ngp_ep0016.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_3/checkpoints/ngp_ep0016.pth ...
[INFO] loaded model.
[INFO] load at epoch 16, global step 5296
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_19-42-23 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_3/checkpoints/ngp_ep0003.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_3/checkpoints/ngp_ep0003.pth ...
[INFO] loaded model.
[INFO] load at epoch 3, global step 993
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_19-42-53 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_3/checkpoints/ngp_ep0008.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_3/checkpoints/ngp_ep0008.pth ...
[INFO] Trainer: ngp | 2023-09-06_19-43-26 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_3/checkpoints/ngp_ep0008.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_3/checkpoints/ngp_ep0008.pth ...
[INFO] loaded model.
[INFO] load at epoch 8, global step 2648
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_19-44-56 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_3/checkpoints/ngp_ep00012.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_3/checkpoints/ngp_ep00012.pth ...
[INFO] Trainer: ngp | 2023-09-06_19-45-49 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_3/checkpoints/ngp.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_3/checkpoints/ngp.pth ...
[INFO] loaded model.
[INFO] load at epoch 12, global step 3972
[INFO] Trainer: ngp | 2023-09-06_19-46-36 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_3/checkpoints/ngp_ep00016.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_3/checkpoints/ngp_ep00016.pth ...
[INFO] Trainer: ngp | 2023-09-06_19-47-09 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_3/checkpoints/ngp_ep0016.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_3/checkpoints/ngp_ep0016.pth ...
[INFO] loaded model.
[INFO] load at epoch 16, global step 5296
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_19-48-11 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_3/checkpoints/ngp_ep0016.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_3/checkpoints/ngp_ep0016.pth ...
[INFO] loaded model.
[INFO] load at epoch 16, global step 5296
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_19-49-18 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_3/checkpoints/ngp.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_3/checkpoints/ngp.pth ...
[INFO] loaded model.
[INFO] load at epoch 6, global step 1986
[INFO] Trainer: ngp | 2023-09-06_19-53-47 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_3/checkpoints/ngp.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_3/checkpoints/ngp.pth ...
[INFO] loaded model.
[INFO] load at epoch 12, global step 3972
[INFO] Trainer: ngp | 2023-09-06_19-55-11 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_3/checkpoints/ngp_ep0016.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_3/checkpoints/ngp_ep0016.pth ...
[INFO] loaded model.
[INFO] load at epoch 16, global step 5296
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_19-57-28 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_3/checkpoints/ngp_ep0016.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_3/checkpoints/ngp_ep0016.pth ...
[INFO] loaded model.
[INFO] load at epoch 16, global step 5296
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_20-36-50 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_4_new_loss/checkpoints/ngp_ep0009.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_4_new_loss/checkpoints/ngp_ep0009.pth ...
[INFO] loaded model.
[INFO] load at epoch 9, global step 2979
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_20-43-50 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_4_new_loss/checkpoints/ngp_ep0016.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, use_rgb_loss=False, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_4_new_loss/checkpoints/ngp_ep0016.pth ...
[INFO] loaded model.
[INFO] load at epoch 16, global step 5296
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_22-26-21 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42175872
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_6_contr/checkpoints/ngp_ep0016.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, redundant_instance=20, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=22, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_6_contr/checkpoints/ngp_ep0016.pth ...
[INFO] loaded model.
[INFO] load at epoch 16, global step 5296
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_22-32-50 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_3/checkpoints/ngp_ep0014.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, redundant_instance=0, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_3/checkpoints/ngp_ep0014.pth ...
[INFO] loaded model.
[INFO] load at epoch 14, global step 4634
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_22-34-07 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_3/checkpoints/ngp_ep0009.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, redundant_instance=0, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_3/checkpoints/ngp_ep0009.pth ...
[INFO] loaded model.
[INFO] load at epoch 9, global step 2979
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_22-35-26 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_3/checkpoints/ngp_ep0015.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, redundant_instance=0, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_3/checkpoints/ngp_ep0015.pth ...
[INFO] loaded model.
[INFO] load at epoch 15, global step 4965
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_22-36-00 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_3/checkpoints/ngp_ep0016.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, redundant_instance=0, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_3/checkpoints/ngp_ep0016.pth ...
[INFO] loaded model.
[INFO] load at epoch 16, global step 5296
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_22-38-44 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42173312
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_6_contr/checkpoints/ngp_ep0031.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, redundant_instance=10, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=12, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_6_contr/checkpoints/ngp_ep0031.pth ...
[INFO] loaded model.
[INFO] load at epoch 31, global step 10261
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_22-42-43 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_3/checkpoints/ngp_ep0018.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, redundant_instance=0, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_3/checkpoints/ngp_ep0018.pth ...
[INFO] loaded model.
[INFO] load at epoch 18, global step 5958
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_22-44-29 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_3/checkpoints/ngp_ep0025.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, redundant_instance=0, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_3/checkpoints/ngp_ep0025.pth ...
[INFO] loaded model.
[INFO] load at epoch 25, global step 8275
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_22-48-12 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_3/checkpoints/ngp_ep0025.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, redundant_instance=0, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_3/checkpoints/ngp_ep0025.pth ...
[INFO] loaded model.
[INFO] load at epoch 25, global step 8275
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_22-49-13 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_3/checkpoints/ngp_ep0023.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, redundant_instance=0, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_3/checkpoints/ngp_ep0023.pth ...
[INFO] loaded model.
[INFO] load at epoch 23, global step 7613
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_22-50-49 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_3/checkpoints/ngp_ep0029.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, redundant_instance=0, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_3/checkpoints/ngp_ep0029.pth ...
[INFO] loaded model.
[INFO] load at epoch 29, global step 9599
[INFO] loaded scaler.
[INFO] Trainer: ngp | 2023-09-06_22-52-04 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_3/checkpoints/ngp.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, redundant_instance=0, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_3/checkpoints/ngp.pth ...
[INFO] loaded model.
[INFO] load at epoch 6, global step 1986
[INFO] Trainer: ngp | 2023-09-06_22-53-03 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_3/checkpoints/ngp.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, redundant_instance=0, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_origin_select_3/checkpoints/ngp.pth ...
[INFO] loaded model.
[INFO] load at epoch 18, global step 5958
[INFO] Trainer: ngp | 2023-09-06_22-59-44 | cuda | fp32 | /ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime
[INFO] #parameters: 42170752
Namespace(path='/ssddata/yliugu/teatime', workspace='/ssddata/yliugu/Segment-Anything-NeRF/sam_mask_teatime', seed=0, ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_3/checkpoints/ngp_ep0031.pth', fp16=False, with_sam=False, init_ckpt='/ssddata/yliugu/Segment-Anything-NeRF/trial1_teatime/checkpoints/ngp.pth', sam_ckpt='./pretrained/sam_vit_h_4b8939.pth', online_resolution=512, cache_size=256, cache_interval=4, save_cnt=20, eval_cnt=5, test=True, camera_traj='interp', train_split='train', test_split='val', preload=True, random_image_batch=True, downscale=1, bound=128, scale=-1, offset=[0, 0, 0], enable_cam_near_far=False, enable_cam_center=True, min_near=0.2, T_thresh=0.0001, iters=20000, lr=0.01, num_steps=[128, 64, 32], contract=True, background='last_sample', max_ray_batch=16384, density_thresh=10, num_rays=16384, adaptive_num_rays=True, num_points=262144, lambda_entropy=0, lambda_tv=0, lambda_wd=0, lambda_proposal=1, lambda_distort=0.02, with_mask=True, lightweight_mask=False, n_inst=2, label_regularization_weight=0.0, patch_size=1, mask_folder_name='masks', incoherent_uncertainty_weight=1, rgb_similarity_loss_weight=0, rgb_similarity_threshold=0.3, rgb_similarity_epsilon=1e-06, rgb_similarity_exp_weight=10, redundant_instance=0, use_wandb=False, use_point=False, val_all=False, render_mask_type='composition', render_mask_instance_id=1, vis_pose=False, gui=True, W=512, H=512, radius=0.5, fovy=60, max_spp=1, data_type='mip')
NeRFNetwork(
  (grid): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 4096 per_level_scale=1.4473 params=(6299960, 2) gridtype=hash align_corners=False interpolation=linear
  (grid_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=32, out_features=64, bias=False)
      (1): Linear(in_features=64, out_features=64, bias=False)
      (2): Linear(in_features=64, out_features=16, bias=False)
    )
  )
  (view_encoder): SHEncoder: input_dim=3 degree=4
  (view_mlp): MLP(
    (net): ModuleList(
      (0): Linear(in_features=31, out_features=32, bias=False)
      (1): Linear(in_features=32, out_features=32, bias=False)
      (2): Linear(in_features=32, out_features=3, bias=False)
    )
  )
  (m_grid): GridEncoder: input_dim=3 num_levels=16 level_dim=8 resolution=16 -> 512 per_level_scale=1.2599 params=(5258512, 8) gridtype=hash align_corners=False interpolation=linear
  (mask_mlp): Sequential(
    (0): SkipConnMLP(
      (net): ModuleList(
        (0): Linear(in_features=143, out_features=256, bias=False)
        (1): Linear(in_features=256, out_features=256, bias=False)
        (2): Linear(in_features=256, out_features=2, bias=False)
      )
    )
  )
  (prop_encoders): ModuleList(
    (0): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 128 per_level_scale=1.6818 params=(383264, 2) gridtype=hash align_corners=False interpolation=linear
    (1): GridEncoder: input_dim=3 num_levels=5 level_dim=2 resolution=16 -> 256 per_level_scale=2.0000 params=(430080, 2) gridtype=hash align_corners=False interpolation=linear
  )
  (prop_mlp): ModuleList(
    (0-1): 2 x MLP(
      (net): ModuleList(
        (0): Linear(in_features=10, out_features=16, bias=False)
        (1): Linear(in_features=16, out_features=1, bias=False)
      )
    )
  )
)
[INFO] Loading /ssddata/yliugu/Segment-Anything-NeRF/trial_mask_with_rgb_sim_3/checkpoints/ngp_ep0031.pth ...
[INFO] loaded model.
[INFO] load at epoch 31, global step 10261
[INFO] loaded scaler.
